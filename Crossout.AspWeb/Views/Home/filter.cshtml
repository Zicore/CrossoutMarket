@using Crossout.Web
@using Crossout.Web.Models.Filter
@model Crossout.Web.Models.General.SearchModel

<div class="card my-1 px-1 d-none" id="filterWrapper">

    <div class="d-flex justify-content-center my-1 row" id="dropdownFilter">
        <div class="btn-group btn-group-sm align-self-start col" role="group">
            <button id="factionsDropdown" type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Faction
            </button>
            <div class="dropdown-menu" aria-labelledby="factionsDropdown">
                @foreach (FilterItem item in Model.FilterModel.Factions)
                {
                    <a class="dropdown-item filter-faction">@item.Name</a>
                }
            </div>
        </div>
        <div class="btn-group btn-group-sm align-self-start col" role="group">
            <button id="categoryDropdown" type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Category
            </button>
            <div class="dropdown-menu" aria-labelledby="categoryDropdown">
                @foreach (FilterItem item in Model.FilterModel.Categories)
                {
                    <a class="dropdown-item filter-category">@item.Name</a>
                }
            </div>
        </div>
        <div class="btn-group btn-group-sm align-self-start col" role="group">
            <button id="rarityDropdown" type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Rarity
            </button>
            <div class="dropdown-menu" aria-labelledby="rarityDropdown">
                @foreach (FilterItem item in Model.FilterModel.Rarities)
                {
                    <a class="dropdown-item filter-rarity">@item.Name</a>
                }
            </div>
        </div>
        <div class="btn-group btn-group-sm align-self-start col" role="group">
            <button id="otherDropdown" type="button" class="btn btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Other
            </button>
            <div class="dropdown-menu" aria-labelledby="otherDropdown">
                <a class="dropdown-item" id="filterRemovedItems">Removed Items</a>
                <a class="dropdown-item" id="filterMetaItems">Meta Items</a>
            </div>
        </div>
    </div>

    <div class="d-none justify-content-center my-1 row" id="expandedFilter">
        <div class="btn-group-vertical btn-group-sm align-self-start col" role="group" aria-label="Faction Filter">
            @foreach (FilterItem item in Model.FilterModel.Factions)
            {
                <button class="btn btn-outline-secondary filter-faction" type="button">@item.Name</button>
            }
        </div>
        <div class="btn-group-vertical btn-group-sm align-self-start col" role="group" aria-label="Category Filter">
            @foreach (FilterItem item in Model.FilterModel.Categories)
            {
                <button class="btn btn-outline-secondary filter-category" type="button">@item.Name</button>
            }
        </div>
        <div class="btn-group-vertical btn-group-sm align-self-start col" role="group" aria-label="Rarity Filter">
            @foreach (FilterItem item in Model.FilterModel.Rarities)
            {
                <button class="btn btn-outline-secondary filter-rarity" type="button">@item.Name</button>
            }
        </div>
        <div class="btn-group-vertical btn-group-sm align-self-start col" role="group" aria-label="special filter">
            <a class="btn btn-outline-secondary" id="filterRemovedItems">Removed Items</a>
            <a class="btn btn-outline-secondary" id="filterMetaItems">Meta Items</a>
        </div>
    </div>

    <div class="input-group input-group-sm my-1">
        <div class="input-group-prepend">
            <span class="input-group-text filter-range-text">Sell Price</span>
        </div>
        <input type="text" class="form-control" id="sellmin" name="sellmin" aria-label="From Amount" placeholder="From">
        <input type="text" class="form-control" id="sellmax" name="sellmax" aria-label="To Amount" placeholder="To">
    </div>

    <div class="input-group input-group-sm my-1">
        <div class="input-group-prepend">
            <span class="input-group-text filter-range-text">Buy Price</span>
        </div>
        <input type="text" class="form-control" id="buymin" name="buymin" aria-label="From Amount" placeholder="From">
        <input type="text" class="form-control" id="buymax" name="buymax" aria-label="To Amount" placeholder="To">
    </div>

    <div class="input-group input-group-sm my-1">
        <div class="input-group-prepend">
            <span class="input-group-text filter-range-text">Margin</span>
        </div>
        <input type="text" class="form-control" id="marginmin" name="marginmin" aria-label="From Amount" placeholder="From">
        <input type="text" class="form-control" id="marginmax" name="marginmax" aria-label="To Amount" placeholder="To">
    </div>
</div>

<script>
    $(document).ready(function () {
        checkFilterSetting();
        $('#filterWrapper').removeClass('d-none');
    });

    function checkFilterSetting() {
        var keepDropdown = readSetting('dropdown');
        if (!keepDropdown) {

            $('#dropdownFilter').removeClass('d-flex');
            $('#dropdownFilter').addClass('d-none');

            $('#expandedFilter').removeClass('d-none');
            $('#expandedFilter').addClass('d-flex');
        }
    }

    $('.dropdown-menu').click(function (e) {
        e.stopPropagation();
    });
</script>